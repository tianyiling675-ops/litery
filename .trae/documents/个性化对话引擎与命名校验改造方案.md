**问题概述**
- 当前聊天仍为通用话术，未结合“心理分析智能体”结果、未针对用户问题进行个性化回应。
- 欢迎语出现“我是我”，缺少有效名称与人格信息绑定。

**目标**
- 生成后对话由“数字分身”驱动，基于心理分析报告个性化回应。
- 针对常见意图（如性别、称呼、名字等）给出明确交互，记录偏好。
- 保留危机检测并在对话前拦截，终止对话与安全提示。
- 右上角按钮保留“添加到网页”，遵循指向性命名要求；生成阶段也做命名约束。

**改动文件**
- `src/components/Hero.tsx`：
  - 将日记上限维持为10000（已完成核对）。
  - 生成时对分身名称做指向性校验（禁止“我/我的数字分身/我的分身/另一个我”等）。
  - 将心理分析报告附加到分身对象（已有占位），补充 traits、writingStyle 字段结构稳定。
- `src/components/ChatInterface.tsx`：
  - 欢迎语改为基于 `analysisReport` 的个性化介绍；若无报告则回退为基础介绍。
  - 新增 `avatarProfile`（性别、称呼、语调风格），允许用户设置与持久化。
  - 实现 `generateReply(message, profile, analysisReport)`：
    - 先做危机检测（已有）；
    - 意图识别：
      - 性别意图（含“男生/女生/性别”）：若无偏好→给出选项并记录；若已设置→用设定回答。
      - 名称/称呼意图：确认当前名称并可建议改名；
      - 情绪/观点类：依据 `traits` 与 `writingStyle` 选择对应语气模板；
      - 兜底：更自然的通用回答，避免重复“我觉得…”。
  - 右上角“添加到网页”保持弹窗重命名流程（已完成），弹窗校验与保存后在示例区展示。
  - 发送按钮在危机模式下禁用（已完成），增加一条说明。
- `src/components/Examples.tsx`：
  - 保持从 `localStorage.sharedAvatars` 读取用户添加分身（已完成）。

**实现要点**
- 命名校验：生成阶段若命名不合规→按钮禁用并提示；通过则允许生成。
- 个性化欢迎语示例：
  - "你好，我是{name}。从你的文字中我看到：{traits简述}。之后我会以{writingStyle}的方式和你交流。"
- 性别意图处理：
  - 未设置：返回“我无法从文字判断你的性别，更希望由你来决定我该如何称呼你（男/女/保留中性）”，并提供快速选项；选择后写入 `avatarProfile.gender`。
- 语气模板：
  - traits 含“理性”→更结构化回答；含“同理心/温柔”→更共情；含“创造力”→更发散；写作风格影响句式长短。

**数据与存储**
- `analysisReport` 挂载在分身对象；
- `avatarProfile` 存储在 `localStorage.avatarProfile:<avatarId>`，页面载入时读取；
- 用户添加到网页的分身存储在 `localStorage.sharedAvatars`（已完成）。

**验证**
- 本地构建通过；
- 用“我是男生还是女生”测试：应返回选项并在选择后记住偏好；
- 非法名称提示不可生成；
- 危机文本测试：应终止对话与提示。

**后续可选**
- 若提供后端接口，替换占位为真实“心理分析智能体”与“数字分身”对话 API；
- 扩充危机词典并按地区提供热线信息。